$.fn.serializeObject=function(){var o={},a=this.serializeArray();return $.each(a,function(){void 0!==o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},"undefined"==typeof magictest&&(magictest={extend:function(obj){window.jQuery.extend(this,obj)}}),jQuery.extend(!0,magictest,{template:{init:function(scope){magictest.template.initLoading(scope)},initLoading:function(scope){jQuery("[data-loading]",scope).each(function(){var $that=jQuery(this);$that.on("click",function(evt){var $container=jQuery($that.data("loading")).length?jQuery($that.data("loading")):$that;if($container.find(".magic-featured-loading").length)return!1;var complete=$that.data("complete"),title=$that.data("title")?$that.data("title"):"",size=$that.data("size"),sizeClass="undefined"!=typeof size?"fa-"+parseInt(size)+"x":"",replace=$that.data("replace")?$that.data("replace"):!1,autoShow=void 0==$that.data("auto-show")?!0:$that.data("auto-show");replace&&!$container.data("cachedContent")&&$container.data("cachedContent",$that.html());var loadingContent='<span class="magic-featured-loading"><i class="magic-featured-loading-icon fa fa-spinner fa-spin '+sizeClass+'"></i>'+title+"</span>";$that.off("show.magicLoading").on("show.magicLoading",function(evt){replace&&$container.empty(),jQuery(loadingContent).css("padding","0px 3px").prependTo($container)}),autoShow&&$that.trigger("show.magicLoading"),complete&&jQuery(document).bind(complete,function(evt){jQuery(".magic-featured-loading",$container).remove(),replace&&$container.html($container.data("cachedContent"))})})})},showMessage:function(message,type){"undefined"==typeof type&&(type="warning");var $messageWrap=jQuery('<div class="alert alert-'+type+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><span class="magic-message-text"></span></div>');"undefined"==typeof container&&(container=".magic-modal"),$messageWrap.find(".magic-message-text").html(message),jQuery(".magic-message",container).html($messageWrap.prop("outerHTML"))}}}),jQuery.extend(!0,magictest,{init:function(scope){"function"==typeof magictest.template.init&&magictest.template.init.apply(this,[scope]);for(feature in magictest)if("template"!==feature&&"function"==typeof magictest[feature].init)try{magictest[feature].init.apply(this,[scope])}catch(err){magictest.log(err)}jQuery(document).trigger("afterMagicInit",scope)}}),jQuery.extend(!0,magictest,{log:function(msg){window.console&&console.log(msg)},getFormData:function(form){return"undefined"==typeof form&&(form="magicForm"),JSON.parse(JSON.stringify(jQuery("#"+form).serializeObject()))}}),jQuery.extend(!0,magictest,{jax:{call:function(func,postData,responseCb,responseFunc){var targetUrl=magictest_jax_targetUrl;"undefined"==typeof postData&&(postData={}),postData.func=func,postData.csrf_token=jQuery('meta[name="csrf_token"]').attr("content"),jQuery.ajax({url:targetUrl,type:"POST",data:postData,dataType:"JSON"}).done(function(resp){try{magictest.jax.onProcessResponse(resp,responseCb)}catch(e){}}).fail(function(){magictest.log("error")}).always(function(data,textStatus){responseFunc&&jQuery.isFunction(responseFunc)&&responseFunc.apply(void 0,[data,textStatus]),magictest.jax.onCompletedLoading(func)})},onProcessResponse:function(resp,responseCb){responseCb&&jQuery.isFunction(responseCb)&&responseCb.apply(void 0,[resp])},onCompletedLoading:function(func){jQuery(document).trigger(func+".magicLoading")}}}),jQuery.extend(!0,magictest,{user:{showRegister:function(){magictest.jax.call("ShowRegister",{},function(resp){var data=resp.data;jQuery(data).modal({show:!0}).on("hidden.bs.modal",function(e){jQuery(this).remove()})})},submitRegister:function(){magictest.jax.call("Register",magictest.getFormData(),function(resp){1==resp.code?magictest.template.showMessage(resp.message):0==resp.code&&(jQuery("#magicForm",".magic-modal").remove(),jQuery(".magic-btn-submit",".magic-modal").remove(),magictest.template.showMessage(resp.message,"success"))})},showLogin:function(){magictest.jax.call("ShowLogin",{},function(resp){var data=resp.data;jQuery(data).modal({show:!0})})},login:function(){magictest.jax.call("Login",magictest.getFormData(),function(resp){1==resp.code?magictest.template.showMessage(resp.message):0==resp.code&&location.reload()})}}}),jQuery(document).ready(function(){magictest.init("body")});